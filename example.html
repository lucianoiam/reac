<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>react-nojsx</title>
  </head>
  <body>
    <div id="root"></div>

    <!-- Load React or Preact -->
    <script src="https://unpkg.com/react/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom/umd/react-dom.production.min.js"></script>
    <!--<script src="https://cdn.jsdelivr.net/npm/preact/dist/preact.min.js"></script>-->

    <!-- Allow to switch between libraries without modifying component.js -->
    <script>window.React = window.React || window.preact;</script>

    <script src="renderer.js"></script>
    <script src="component.js"></script>

    <script>

    class ChildComponent extends ReactNoJSX.Component {

        renderHTML() {
            return `<div>Count: ${this.props.count}</div>`;
        }

    }

    class ParentComponent extends ReactNoJSX.Component {

        constructor(props) {
            super(props, { ChildComponent });
            
            this.state = { count : 0, text: '' };
        }

        renderHTML() {
            return `<div>
                        <button onClick="{this.incrementCount}">Click me</button>
                        <ChildComponent count="${this.state.count}"></ChildComponent>
                    </div>
                    <hr>
                    <div>
                        <textarea
                            placeholder="Type something"
                            onInput="{ ev => this.setState(p => ({ text: ev.target.value, count: p.count })) }"></textarea>
                        <div>${this.state.text}</div>
                    </div>`;
        }

        incrementCount() {
            this.setState(prevState => ({ count: prevState.count + 1, text: prevState.text }));
        }

    }

    const root = document.getElementById('root');

    if (typeof(preact) !== 'undefined') {
        preact.render(preact.createElement(ParentComponent), root);
    } else {
        ReactDOM.createRoot(root).render(React.createElement(ParentComponent));
    }

    </script>

  </body>
</html>
